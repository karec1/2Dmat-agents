translations = {
    'en': {
        'home': 'Home',
        'browse': 'Browse',
        'add_material': 'Add Material',
        'add_new_material': 'Add New Material',
        'profile': 'Profile',
        'login': 'Login',
        'register': 'Register',
        'logout': 'Logout',
        'search': 'Search',
        'filters': 'Filters',
        'formula': 'Formula',
        'magnetic_order': 'Magnetic Order',
        'min_tc': 'Min Tc (K)',
        'apply_filters': 'Apply Filters',
        'reset': 'Reset',
        'statistics': 'Statistics',
        'found': 'Found',
        'ferromagnets': 'Ferromagnets',
        'materials': 'Materials',
        'materials_count': 'Materials in Database',
        'name': 'Name',
        'structure': 'Structure',
        'band_gap': 'Band Gap (eV)',
        'magnetic_moment': 'Magnetic Moment',
        'curie_temp': 'Tc (K)',
        'actions': 'Actions',
        'verified': 'Verified',
        'not_verified': 'Not Verified',
        'yes': 'Yes',
        'no': 'No',
        'verification': 'Verification',
        'waiting_verification': 'Waiting for Verification',
        'verified_score': 'Verified Score',
        'details': 'Details',
        'crystal_system': 'Crystal System',
        'space_group': 'Space Group',
        'calculation_method': 'Calculation Method',
        'functional': 'Functional',
        'software': 'Software',
        'magnetic_properties': 'Magnetic Properties',
        'electronic_properties': 'Electronic Properties',
        'comments': 'Comments',
        'add_comment': 'Add Comment',
        'bookmarks': 'Bookmarks',
        'my_materials': 'My Materials',
        'edit_profile': 'Edit Profile',
        'change_password': 'Change Password',
        'admin_panel': 'Admin Panel',
        'total_materials': 'Total Materials',
        'pending_verification': 'Pending Verification',
        'users': 'Users',
        'management': 'Management',
        'save': 'Save',
        'cancel': 'Cancel',
        'delete': 'Delete',
        'edit': 'Edit',
        'view': 'View',
        'submit': 'Submit',
        'confirm_delete': 'Are you sure you want to delete?',
        'success': 'Success',
        'error': 'Error',
        'approved': 'Approved',
        'rejected': 'Rejected',
        'in_progress': 'In Progress',
        'welcome': 'Welcome to 2D Materials Database',
        'welcome_desc': 'Browse and manage 2D materials with DFT-calculated properties',
        'recent_materials': 'Recent Materials',
        'top_materials': 'Top Viewed',
        'verified_materials': 'Verified Materials',
        'total': 'Total',
        'no_materials_found': 'No materials found with current filters',
        'show_all': 'Show All',
        'verified_experts': 'Verified by Experts',
        'verified_only': 'Verified Only',
        'all': 'All',
        'crystal_system_filter': 'Crystal System',
        'space_group_filter': 'Space Group',
        'band_gap_filter': 'Max Band Gap (eV)',
        'magnetic': 'Magnetic',
        'non_magnetic': 'Non-Magnetic',
        'fm': 'FM',
        'afm': 'AFM',
        'structural_properties': 'Structural Properties',
        'computational_parameters': 'Computational Parameters',
        'electronic_properties_tab': 'Electronic Properties',
        'magnetic_properties_tab': 'Magnetic Properties',
        'visualization': 'Visualization',
        'structure_visualization': 'Structure Visualization',
        'band_structure': 'Band Structure',
        'dos': 'Density of States',
        'lattice_parameters': 'Lattice Parameters',
        'interactive_view': 'Interactive View',
        'computational_files': 'Computational Files',
        'cif_file': 'CIF Structure File',
        'poscar_file': 'POSCAR File',
        'download': 'Download',
        'author': 'Author',
        'created_at': 'Created',
        'updated_at': 'Updated',
        'views': 'Views',
        'downloads': 'Downloads',
        'citations': 'Citations',
        'references': 'References',
        'doi': 'DOI',
        'tags': 'Tags',
        'applications': 'Applications',
        'formation_energy': 'Formation Energy (eV/atom)',
        'exfoliation_energy': 'Exfoliation Energy (meV/A2)',
        'elastic_constants': 'Elastic Constants',
        'young_modulus': 'Young Modulus (GPa)',
        'poisson_ratio': 'Poisson Ratio',
        'magnetic_moment_per_cell': 'Magnetic Moment per Cell (muB)',
        'easy_axis': 'Easy Axis',
        'anisotropy_energy': 'Anisotropy Energy (meV)',
        'exchange_parameters': 'Exchange Parameters',
        'dmi': 'DMI Constant (meV)',
        'curie_temperature': 'Curie Temperature (K)',
        'neel_temperature': 'Neel Temperature (K)',
        'verification_details': 'Verification Details',
        'quality_score': 'Quality Score',
        'expert_notes': 'Expert Notes',
        'methodology_notes': 'Methodology Notes',
        'data_quality_notes': 'Data Quality Notes',
        'suggested_improvements': 'Suggested Improvements',
        'verification_date': 'Verification Date',
        'verified_by': 'Verified By',
        'expert': 'Expert',
        'only_experts_can_verify': 'Only experts can verify materials',
        'technical_comment': 'Technical Comment',
        'rating': 'Rating',
        'submit_review': 'Submit Review',
        'approve': 'Approve',
        'reject': 'Reject',
        'save_changes': 'Save Changes',
        'add_to_bookmarks': 'Add to Bookmarks',
        'remove_from_bookmarks': 'Remove from Bookmarks',
        'share': 'Share',
        'json_data': 'JSON Data',
        'api_documentation': 'API Documentation',
        'csv_export': 'CSV Export',
        'username': 'Username',
        'email': 'Email',
        'full_name': 'Full Name',
        'affiliation': 'Affiliation',
        'orcid': 'ORCID',
        'role': 'Role',
        'registration_date': 'Registration Date',
        'admin': 'Administrator',
        'expert_role': 'Expert',
        'user': 'User',
        'my_bookmarks': 'My Bookmarks',
        'my_verifications': 'My Verifications',
        'no_materials': 'No materials yet',
        'add_first_material': 'Add First Material',
        'no_bookmarks': 'No bookmarks yet',
        'no_comments': 'No comments yet',
        'login_required': 'Please login to access this page',
        'login_success': 'Successfully logged in',
        'login_failed': 'Invalid username or password',
        'logout_success': 'Successfully logged out',
        'registration_success': 'Registration successful! You can now login.',
        'username_taken': 'Username already taken',
        'email_taken': 'Email already in use',
        'passwords_not_match': 'Passwords do not match',
        'material_added': 'Material added successfully',
        'material_updated': 'Material updated successfully',
        'material_deleted': 'Material deleted successfully',
        'comment_added': 'Comment added successfully',
        'profile_updated': 'Profile updated successfully',
        'password_changed': 'Password changed successfully',
        'invalid_current_password': 'Invalid current password',
        'new_passwords_not_match': 'New passwords do not match',
        'access_denied': 'Access Denied',
        'material_not_found': 'Material Not Found',
        'page_not_found': 'Page Not Found',
        'internal_error': 'Internal Server Error',
        'please_login': 'Please login to continue',
        'remember_me': 'Remember Me',
        'forgot_password': 'Forgot Password?',
        'dont_have_account': "Don't have an account?",
        'already_have_account': 'Already have an account?',
        'sign_up': 'Sign Up',
        'confirm_password': 'Confirm Password',
        'current_password': 'Current Password',
        'new_password': 'New Password',
        'profile_picture': 'Profile Picture',
        'save_profile': 'Save Profile',
        'verification_waiting': 'This material is waiting for verification',
        'contact_expert': 'Contact an expert for verification',
        'verify_material': 'Verify Material',
        'edit_material': 'Edit Material',
        'delete_material': 'Delete Material',
        'first_material': 'Add your first material to get started',
        'verification_list': 'Verification List',
        'pending_materials': 'Materials Pending Verification',
        'backup': 'Backup',
        'database_backups': 'Database Backups',
        'create_backup': 'Create Backup',
        'available_backups': 'Available Backups',
        'filename': 'Filename',
        'size': 'Size',
        'created': 'Created',
        'restore': 'Restore',
        'download': 'Download',
        'no_backups': 'No backups available',
        'backup_info': 'Backup Information',
        'backup_info_1': 'Backups are stored in the /backups folder',
        'backup_info_2': 'Before restoring, a backup of current database is created',
        'backup_info_3': 'Only administrators can create and restore backups',
        'back': 'Back',
    },
    'ru': {
        'home': 'Главная',
        'browse': 'Каталог',
        'add_material': 'Добавить материал',
        'add_new_material': 'Добавить новый материал',
        'profile': 'Профиль',
        'login': 'Войти',
        'register': 'Регистрация',
        'logout': 'Выйти',
        'search': 'Поиск',
        'filters': 'Фильтры',
        'formula': 'Формула',
        'magnetic_order': 'Магнитный порядок',
        'min_tc': 'Мин. Tc (K)',
        'apply_filters': 'Применить фильтры',
        'reset': 'Сбросить',
        'statistics': 'Статистика',
        'found': 'Найдено',
        'ferromagnets': 'Ферромагнетиков',
        'materials': 'Материалы',
        'materials_count': 'Материалов в базе',
        'name': 'Название',
        'structure': 'Структура',
        'band_gap': 'Ширина зоны (эВ)',
        'magnetic_moment': 'Магнитный момент',
        'curie_temp': 'Tc (K)',
        'actions': 'Действия',
        'verified': 'Верифицирован',
        'not_verified': 'Не верифицирован',
        'yes': 'Да',
        'no': 'Нет',
        'verification': 'Верификация',
        'waiting_verification': 'Ожидает верификации',
        'verified_score': 'Балл верификации',
        'details': 'Подробнее',
        'crystal_system': 'Кристаллическая система',
        'space_group': 'Пространственная группа',
        'calculation_method': 'Метод расчёта',
        'functional': 'Функционал',
        'software': 'Программа',
        'magnetic_properties': 'Магнитные свойства',
        'electronic_properties': 'Электронные свойства',
        'comments': 'Комментарии',
        'add_comment': 'Добавить комментарий',
        'bookmarks': 'Закладки',
        'my_materials': 'Мои материалы',
        'edit_profile': 'Редактировать профиль',
        'change_password': 'Изменить пароль',
        'admin_panel': 'Админ-панель',
        'total_materials': 'Всего материалов',
        'pending_verification': 'На верификации',
        'users': 'Пользователей',
        'management': 'Управление',
        'save': 'Сохранить',
        'cancel': 'Отмена',
        'delete': 'Удалить',
        'edit': 'Редактировать',
        'view': 'Просмотр',
        'submit': 'Отправить',
        'confirm_delete': 'Вы уверены, что хотите удалить?',
        'success': 'Успешно',
        'error': 'Ошибка',
        'welcome': 'Добро пожаловать в базу 2D материалов',
        'welcome_desc': 'Просмотр и управление 2D материалами с DFT-рассчитанными свойствами',
        'recent_materials': 'Последние материалы',
        'top_materials': 'Популярные',
        'verified_materials': 'Верифицированные',
        'total': 'Всего',
        'no_materials_found': 'Материалы по заданным фильтрам не найдены',
        'show_all': 'Показать все',
        'verified_experts': 'Верифицировано экспертами',
        'verified_only': 'Только верифицированные',
        'all': 'Все',
        'crystal_system_filter': 'Кристаллическая система',
        'space_group_filter': 'Пространственная группа',
        'band_gap_filter': 'Макс. ширина зоны (эВ)',
        'magnetic': 'Магнитный',
        'non_magnetic': 'Немагнитный',
        'fm': 'ФМ',
        'afm': 'АФМ',
        'structural_properties': 'Структурные свойства',
        'computational_parameters': 'Параметры расчёта',
        'electronic_properties_tab': 'Электронные свойства',
        'magnetic_properties_tab': 'Магнитные свойства',
        'visualization': 'Визуализация',
        'structure_visualization': 'Визуализация структуры',
        'band_structure': 'Зонная структура',
        'dos': 'Плотность состояний',
        'lattice_parameters': 'Параметры решётки',
        'interactive_view': 'Интерактивный просмотр',
        'computational_files': 'Вычислительные файлы',
        'cif_file': 'CIF файл структуры',
        'poscar_file': 'POSCAR файл',
        'download': 'Скачать',
        'author': 'Автор',
        'created_at': 'Создан',
        'updated_at': 'Обновлён',
        'views': 'Просмотры',
        'downloads': 'Загрузки',
        'citations': 'Цитирования',
        'references': 'Ссылки',
        'doi': 'DOI',
        'tags': 'Теги',
        'applications': 'Применения',
        'formation_energy': 'Энергия образования (эВ/атом)',
        'exfoliation_energy': 'Энергия отщепления (мэВ/А2)',
        'elastic_constants': 'Упругие константы',
        'young_modulus': 'Модуль Юнга (ГПа)',
        'poisson_ratio': 'Коэффициент Пуассона',
        'magnetic_moment_per_cell': 'Магнитный момент на ячейку (мюB)',
        'easy_axis': 'Лёгкая ось',
        'anisotropy_energy': 'Энергия анизотропии (мэВ)',
        'exchange_parameters': 'Параметры обмена',
        'dmi': 'Константа DMI (мэВ)',
        'curie_temperature': 'Температура Кюри (K)',
        'neel_temperature': 'Температура Нееля (K)',
        'verification_details': 'Детали верификации',
        'quality_score': 'Оценка качества',
        'expert_notes': 'Замечания эксперта',
        'methodology_notes': 'Замечания по методологии',
        'data_quality_notes': 'Замечания по качеству данных',
        'suggested_improvements': 'Предложения по улучшению',
        'verification_date': 'Дата верификации',
        'verified_by': 'Кем верифицирован',
        'expert': 'Эксперт',
        'only_experts_can_verify': 'Только эксперты могут верифицировать материалы',
        'technical_comment': 'Технический комментарий',
        'rating': 'Оценка',
        'submit_review': 'Отправить отзыв',
        'approve': 'Одобрить',
        'reject': 'Отклонить',
        'save_changes': 'Сохранить изменения',
        'add_to_bookmarks': 'В закладки',
        'remove_from_bookmarks': 'Удалить из закладок',
        'share': 'Поделиться',
        'json_data': 'JSON данные',
        'api_documentation': 'API документация',
        'csv_export': 'Экспорт CSV',
        'username': 'Имя пользователя',
        'email': 'Email',
        'full_name': 'Полное имя',
        'affiliation': 'Организация',
        'orcid': 'ORCID',
        'role': 'Роль',
        'registration_date': 'Дата регистрации',
        'admin': 'Администратор',
        'expert_role': 'Эксперт',
        'user': 'Пользователь',
        'my_bookmarks': 'Мои закладки',
        'my_verifications': 'Мои верификации',
        'no_materials': 'Пока нет материалов',
        'add_first_material': 'Добавить первый материал',
        'no_bookmarks': 'Пока нет закладок',
        'no_comments': 'Пока нет комментариев',
        'login_required': 'Пожалуйста, войдите для доступа к этой странице',
        'login_success': 'Вы успешно вошли в систему',
        'login_failed': 'Неверное имя пользователя или пароль',
        'registration_success': 'Регистрация успешна! Теперь вы можете войти.',
        'username_taken': 'Это имя пользователя уже занято',
        'email_taken': 'Этот email уже используется',
        'passwords_not_match': 'Пароли не совпадают',
        'material_added': 'Материал успешно добавлен',
        'material_updated': 'Материал успешно обновлён',
        'material_deleted': 'Материал успешно удалён',
        'comment_added': 'Комментарий добавлен',
        'profile_updated': 'Профиль успешно обновлён',
        'password_changed': 'Пароль успешно изменён',
        'invalid_current_password': 'Неверный текущий пароль',
        'new_passwords_not_match': 'Новые пароли не совпадают',
        'access_denied': 'Доступ запрещён',
        'material_not_found': 'Материал не найден',
        'page_not_found': 'Страница не найдена',
        'internal_error': 'Внутренняя ошибка сервера',
        'please_login': 'Пожалуйста, войдите для продолжения',
        'remember_me': 'Запомнить меня',
        'forgot_password': 'Забыли пароль?',
        'dont_have_account': 'Нет аккаунта?',
        'already_have_account': 'Уже есть аккаунт?',
        'sign_up': 'Регистрация',
        'confirm_password': 'Подтвердите пароль',
        'current_password': 'Текущий пароль',
        'new_password': 'Новый пароль',
        'profile_picture': 'Фото профиля',
        'save_profile': 'Сохранить профиль',
        'verification_waiting': 'Этот материал ожидает верификации',
        'contact_expert': 'Свяжитесь с экспертом для верификации',
        'verify_material': 'Верифицировать материал',
        'edit_material': 'Редактировать материал',
        'delete_material': 'Удалить материал',
        'first_material': 'Добавьте первый материал',
        'verification_list': 'Лист верификации',
        'pending_materials': 'Материалы на верификации',
    }
}

def get_locale():
    from flask import session, request
    return session.get('language', request.accept_languages.best_match(['en', 'ru']))

def t(key):
    lang = get_locale() or 'en'
    return translations.get(lang, translations['en']).get(key, key)
